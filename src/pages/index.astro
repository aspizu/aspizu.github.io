---
import "@fontsource-variable/figtree"
import "../styles/global.css"
import Mail from "@lucide/astro/icons/mail"
import {Fragment} from "astro/jsx-runtime"
import LastFM from "../components/LastFM.astro"
import Project from "../components/Project.astro"
import Socials from "../components/Socials.astro"
import StatusCafe from "../components/StatusCafe.astro"
import projects from "../data/projects.json"
import Tooltip from "../components/Tooltip.astro"
---

<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>aspiz.uk</title>
        <script
            is:inline
            src="https://louisabraham.github.io/nekojs/neko.js"
            data-autostart></script>
        <script src="https://cdn.jsdelivr.net/npm/htmx.org@2.0.8/dist/htmx.min.js"
        ></script>
        <script src="https://unpkg.com/hyperscript.org@0.9.14"></script>
    </head>
    <body class="relative bg-black">
        <div
            class="scheme-dark bg-black text-white grid grid-cols-[1fr_min(24rem,100%-1rem)_1fr] pb-16"
        >
            <div class="col-2 my-16 relative grid bg-linear-to-b p-1 rounded-3xl card">
                <div
                    class="flex relative flex-col gap-4 bg-linear-to-b from-black to-black/25 rounded-[21px] shadow"
                >
                    <StatusCafe />
                    <div
                        class="relative rounded-[21px] rounded-b-none h-32 w-full bg-[url('/banner.png')] bg-cover bg-top opacity-50"
                    >
                    </div>
                    <img
                        id="avatar"
                        src="/avatar.png"
                        alt="avatar"
                        class="absolute top-8 left-4 size-32 rounded-full border border-black shadow"
                    />
                    <div class="flex flex-col p-4 pt-8">
                        <h1 class="text-2xl font-medium">
                            <img
                                src="/minecraft_title.png"
                                alt="aspizu"
                                class="h-6 inline-block"
                            />
                            <span class="text-neutral-400 font-light">he/him</span>
                            <img src="/india.png" class="inline size-6" />
                        </h1>
                        <p>
                            I'm a recreational coder, sometimes I make (often terrible)
                            music. I'm currently looking for a job.
                        </p>

                        <LastFM />
                        <Socials />
                    </div>
                </div>
                <a
                    href="mailto:aspizu@protonmail.com"
                    class="absolute top-4 right-4 z-10 inline-flex items-center justify-center gap-1 px-2 py-1 bg-white/85 hover:bg-white text-black font-medium rounded-lg transition-colors duration-200 shadow-md hover:shadow-lg text-sm"
                >
                    <Mail class="size-3.5" />
                    email me
                </a>
            </div>

            <h1 class="col-2 relative text-sm mx-auto font-semibold px-1 bg-black z-3">
                PROJECTS
            </h1>
            <div class="col-2 -translate-y-2.75 h-px bg-white/10"></div>
            {projects.map((project) => <Project {...project} />)}
        </div>
        <div class="footer"></div>
    </body>
</html>

<script>
    import {GhostCursor} from "../scripts/ghost-cursor.ts"
    // import "../scripts/main.ts"
    const cursor = new GhostCursor()
    const avatar = document.getElementById("avatar")
    let sr = 14.5
    let r = 0
    let interval = null
    function update() {
        sr *= 0.99
        r += sr
        avatar.style.rotate = `${r}deg`
        if (sr < 0.01) {
            clearInterval(interval)
        }
    }
    interval = setInterval(update, 25)
    function setBgColor() {
        const maxScroll = document.body.scrollHeight - window.innerHeight
        const gradientHeight = 128

        // Calculate how far into the gradient zone we are
        const distanceFromBottom = maxScroll - window.scrollY
        const scrollPercent = Math.max(
            0,
            Math.min(1, 1 - distanceFromBottom / gradientHeight),
        )

        // Interpolate from black (0,0,0) to red (141,48,48)
        const r = Math.round(141 * scrollPercent)
        const g = Math.round(48 * scrollPercent)
        const b = Math.round(48 * scrollPercent)

        document.body.style.backgroundColor = `rgb(${r}, ${g}, ${b})`
    }
    window.addEventListener("scroll", setBgColor)
</script>
